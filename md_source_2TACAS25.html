<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.12.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Painless: Reproducing D-Painless SAT Solver Experiments from TACAS25</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <link rel="icon" type="image/png" href="p-logo.png"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/javascript" src="darkmode_toggle.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
  </script>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo"><a href=index.html><img alt="Logo" src="p-logo.png" /></a></td>
              <td id="projectalign">
                <div id="projectname">Painless
                </div>
                <div id="projectbrief">A framework to ease parallelization of sequential CDCL SAT solvers</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Reproducing D-Painless SAT Solver Experiments from TACAS25</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="reproducing-d-painless-sat-solver-experiments-from-tacas25"></a></p>
<p>This guide details how to reproduce the experimental results presented in our TACAS25 paper. We evaluated four different configurations of Painless, each representing different sharing strategies and solver combinations.</p>
<dl class="section important"><dt>Important</dt><dd>On October 21st,2024, we were notified that the <a href="https://www.grid5000.fr/w/Rennes:Hardware#paravance">paravance</a> cluster will become unavailable after November 4th,2024. We apologize for these circumstances. You can test on the <a href="https://www.grid5000.fr/w/Rennes:Hardware#parasilo">parasilo</a> cluster which has the same CPU as paravance, however only 24 nodes are available. <div class="fragment"><div class="line">oarsub -l nodes=24,walltime=13:30:00 -p &quot;cluster=&#39;parasilo&#39;&quot; -t night &quot;bash launch_solvers.sh`</div>
</div><!-- fragment --></dd></dl>
<h1><a class="anchor" id="experimental-environment"></a>
Experimental Environment</h1>
<h2><a class="anchor" id="hardware-configuration"></a>
Hardware Configuration</h2>
<ul>
<li><b>Platform</b>: Grid5000 Paravance Cluster</li>
<li><b>Nodes</b>: 25 machines (50 CPUs total)</li>
<li><b>Architecture</b>: 2 Intel Xeon E5-2630 v3 per node, with 8 cores/CPU (16 cores/node)</li>
<li><b>Main Memory</b>: 128 GiB/node</li>
<li><b>Network</b>: 2 x 10 Gbps (SR‑IOV)</li>
</ul>
<h2><a class="anchor" id="software-environment"></a>
Software Environment</h2>
<ul>
<li><b>Operating System</b>: Debian 11 (bullseye)</li>
<li><b>MPI Implementation</b>: OpenMPI 4.1.0</li>
<li><b>Compiler</b>: GCC 10.2.1</li>
</ul>
<h2><a class="anchor" id="setup"></a>
Setup</h2>
<h2><a class="anchor" id="environment-setup"></a>
Environment Setup:</h2>
<div class="fragment"><div class="line"># Set up hostfile from node allocation in bashrc</div>
<div class="line">export HOSTFILE=~/software/hostfile</div>
<div class="line">uniq $OAR_NODE_FILE &gt; $HOSTFILE</div>
</div><!-- fragment --><h2><a class="anchor" id="benchmark-instances"></a>
Benchmark Instances</h2>
<p>The instances can be downloaded via:</p>
<div class="fragment"><div class="line">wget --content-disposition https://gist.githubusercontent.com/S-Mazigh/f6ad9157a7f47cffb34887ab0bfd203b/raw/5ccb9c5db1ebeeba4a1e6ea39b0b6c361d6b9910/track_tacas25_painless.uri</div>
<div class="line">mkdir cnf &amp;&amp; cd cnf</div>
<div class="line">wget --content-disposition -i ../track_tacas25_painless.uri</div>
</div><!-- fragment --><dl class="section important"><dt>Important</dt><dd>The instances from the International SAT Competition 2024(<a href="https://benchmark-database.de/?track=main_2024&amp;context=cnf">GBD-ISC24</a>) were used. However, due to some out of memory errors, not all instances were solved. The intersection of the non crashed instances can be found <a href="https://gist.github.com/S-Mazigh/f6ad9157a7f47cffb34887ab0bfd203b">here</a>.</dd></dl>
<h2><a class="anchor" id="tool-specific-setup"></a>
Tool-Specific Setup</h2>
<h3>D-Painless</h3>
<div class="fragment"><div class="line">cd /path/to/painless</div>
<div class="line">make</div>
</div><!-- fragment --><h3>Mallob</h3>
<ul>
<li>Please note that jemalloc was unavailable <div class="fragment"><div class="line">cd /path/to/mallob</div>
<div class="line">bash ./lib/fetch_and_build_solvers.sh</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">CC=$(which mpicc) CXX=$(which mpicxx) cmake -DCMAKE_BUILD_TYPE=RELEASE \</div>
<div class="line">    -DMALLOB_APP_SAT=1 \</div>
<div class="line">    -DMALLOB_USE_JEMALLOC=0 \</div>
<div class="line">    -DMALLOB_LOG_VERBOSITY=4 \</div>
<div class="line">    -DMALLOB_ASSERT=1 \</div>
<div class="line">    -DMALLOB_SUBPROC_DISPATCH_PATH=\&quot;build/\&quot; ..</div>
<div class="line">make</div>
</div><!-- fragment --></li>
</ul>
<h3>PRS</h3>
<div class="fragment"><div class="line">cd /path/to/PRS-distributed-sc24</div>
<div class="line">bash ./build.sh</div>
</div><!-- fragment --><h1><a class="anchor" id="running-experiments"></a>
Running Experiments</h1>
<h2><a class="anchor" id="grid5000-execution"></a>
Grid5000 Execution</h2>
<div class="fragment"><div class="line"># Reserve 25 nodes on Paravance cluster</div>
<div class="line">oarsub -l nodes=25,walltime=15:00:00 -p &quot;cluster=&#39;paravance&#39;&quot; -t night &quot;bash ~/jobs_out/launch_solvers.sh&quot;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Each benchmark requires at least 15 hours of execution time.</dd></dl>
<h3>Create Input File List:</h3>
<ul>
<li>Create a text file containing paths to CNF formulas, one per line. <div class="fragment"><div class="line">ls -d /absolute/path/to/cnfs/*.cnf &gt;formula_list.txt</div>
</div><!-- fragment --></li>
</ul>
<h3>Launch Script:</h3>
<ul>
<li>For each configuration: <div class="fragment"><div class="line">./scripts/launch.sh scripts/&lt;config&gt;-params.sh formula_list.txt [experiment_name]</div>
</div><!-- fragment --></li>
<li>Example runs for each configuration: <div class="fragment"><div class="line"># in launch-solvers.sh</div>
<div class="line"> </div>
<div class="line"># PL-Mallob-kc</div>
<div class="line">cd path/to/painless &amp;&amp; bash ./scripts/launch.sh scripts/mallob-params.sh formulas.txt PL-Mallob-kc</div>
<div class="line"> </div>
<div class="line"># PL-Horde+Generic-PRS</div>
<div class="line">cd path/to/painless &amp;&amp; bash ./scripts/launch.sh scripts/prs-params.sh formulas.txt PL-Horde+Generic-PRS</div>
<div class="line"> </div>
<div class="line"># PL-Horde+Mallob-kc</div>
<div class="line">cd path/to/painless &amp;&amp; bash ./scripts/launch.sh scripts/horde-mallob-params.sh formulas.txt PL-Horde+Mallob-kc</div>
<div class="line"> </div>
<div class="line"># PL-Horde+Allgather-kc</div>
<div class="line">cd path/to/painless &amp;&amp; bash ./scripts/launch.sh scripts/allgather-params.sh formulas.txt PL-Horde+Allgather-kc</div>
</div><!-- fragment --></li>
</ul>
<h3>Run in Grid5000:</h3>
<div class="fragment"><div class="line"># Reserve 25 nodes on Paravance cluster for a night</div>
<div class="line">oarsub -l nodes=25,walltime=13:30:00 -p &quot;cluster=&#39;paravance&#39;&quot; -t night &quot;bash /path/to/launch-solvers.sh&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="configuration-files-explained"></a>
Configuration Files Explained</h1>
<p>The experiments use parameter files located in the <code>scripts/</code> directory. Each file configures Painless for a specific sharing strategy and solver combination.</p>
<h2><a class="anchor" id="common-parameters-across-configurations"></a>
Common Parameters Across Configurations</h2>
<p>All configurations share some base parameters: </p><div class="fragment"><div class="line">nb_physical_cores=$(lscpu | grep ^Core\&zwj;(s\&zwj;)\\sper\\ssocket:\\s | awk &#39;{print $4}&#39;)</div>
<div class="line">nb_solvers=$nb_physical_cores     # One solver per physical core</div>
<div class="line">verbose=1                         # Enable basic logging</div>
<div class="line">timeout=500                       # Timeout in seconds</div>
<div class="line"> </div>
<div class="line">hostfile=$HOSTFILE # Hostfile is set to the environment variable</div>
<div class="line"># Number of mpi processes == number of sockets per node * number of nodes</div>
<div class="line">nb_procs_per_node=$(lscpu | grep ^Socket\&zwj;(s\&zwj;):\\s | awk &#39;{print $2}&#39;)</div>
<div class="line">nb_nodes=$(ls $hostfile | wc)</div>
<div class="line"># mpi mapping in launch.sh is:</div>
<div class="line"># --bind-to hwthread --map-by ppr:$nb_procs_per_node:node:pe=$nb_physical_cores</div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>In case, you want to run the tools in a local machine, you have only to set manually the <code>nb_procs_per_node</code> and <code>nb_physical_cores</code> variables to the wanted values of MPI processes and solvers per MPI process, respectively.</dd></dl>
<h2><a class="anchor" id="configuration-details"></a>
Configuration Details</h2>
<ul>
<li>Most of the options are used with their default values, thus they are not set in the configuration files.</li>
</ul>
<ol type="1">
<li><b>PL-Mallob-kc</b> (mallob-params.sh) <div class="fragment"><div class="line">solver=&quot;kc&quot;                       # Kissat and cadical as base solvers</div>
<div class="line">lstrat=-1                        # Disable local sharing strategies (no hordesat or simple share)</div>
<div class="line">gstrat=2                         # Mallob global sharing</div>
<div class="line">sharing_per_sec=2                # Share clauses twice per second</div>
<div class="line">gshr_lit=$(($nb_physical_cores * 400 / $sharing_per_sec))  # Base buffer size</div>
<div class="line">flags=&quot;-simple -mallob -gshr-sleep=10000 -gshr-lit=${gshr_lit} -importDB-cap=$(($gshr_lit * 10))&quot; # Use PortfolioSimple in Mallob mode</div>
</div><!-- fragment --></li>
<li><b>PL-Horde+Generic-PRS</b> (prs-params.sh) <div class="fragment"><div class="line">solver=&quot;IMl&quot;  # Kissat-Inc, MapleCompls, and lingeling</div>
<div class="line"># shr-strat and -gshr-strat options are only used for naming</div>
<div class="line">flags=&quot;-gshr-lit=0 -one-sharer -gshr-sleep=0&quot;  # Single sharer configuration using PortfolioPRS with unlimited buffer for GenericGlobalSharing</div>
</div><!-- fragment --></li>
<li><b>PL-Horde+Mallob-kc</b> (horde-mallob-params.sh) <div class="fragment"><div class="line">solver=&quot;kc&quot;                      # Kissat and Cadical as base solvers</div>
<div class="line">lstrat=1                        # Local sharing via HordeSat</div>
<div class="line">gstrat=2                        # Global Mallob sharing</div>
<div class="line">sharing_per_sec=2               # Share clauses twice per second</div>
<div class="line">gshr_lit=$(($nb_physical_cores * 400 / $sharing_per_sec))</div>
<div class="line">flags=&quot;-simple -gshr-sleep=300000 -importDB=m -importDB-cap=$(($gshr_lit * 10)) -gshr-lit=${gshr_lit}&quot; # Use PortfolioSimple</div>
</div><!-- fragment --></li>
<li><b>PL-Horde+Allgather-kc</b> (allgather-params.sh) <div class="fragment"><div class="line">solver=&quot;kc&quot;      # Kissat and Cadical as base solvers</div>
<div class="line">lstrat=1         # Local sharing via HordeSat</div>
<div class="line">gstrat=1         # All-gather global sharing</div>
<div class="line">shr_sleep=200000 # Sleep time for HordSat</div>
<div class="line">gshr_lit=$(($nb_physical_cores * 1500))</div>
<div class="line">flags=&quot;-simple -gshr-sleep=300000 -gshr-lit=${gshr_lit}&quot; # Use PortfolioSimple</div>
</div><!-- fragment --></li>
</ol>
<dl class="section note"><dt>Note</dt><dd>Grid 5000 Specific Notes:<ul>
<li>The MPI configuration automatically adapts to the Grid5000 environment using the provided hostfile</li>
<li>The parameter files detect the number of physical cores per node using <code>lscpu</code></li>
<li>The launch script includes Grid5000-specific MPI flags: <code>--mca pml ^ucx</code></li>
<li>The MPI job is aborted if a solution was found and returned by a process (return value = 10 or 20) due to the option <code>--mca orte_abort_on_non_zero_status true</code></li>
</ul>
</dd></dl>
<h1><a class="anchor" id="analysis"></a>
Analysis</h1>
<ul>
<li>Results are organized in the <code>outputs/</code> directory: <div class="fragment"><div class="line">outputs/</div>
<div class="line">  ├── metric_${solver}_L${lstrat}_G${gstrat}_${timestamp}/</div>
<div class="line">  │   ├── logs/                    # Per-instance solver logs</div>
<div class="line">  │   ├── times_*.csv             # Detailed timing results</div>
<div class="line">  └── times.csv                   # Summary of all experiments</div>
</div><!-- fragment --></li>
<li>Use the provided plotting script to analyze results:</li>
</ul>
<div class="fragment"><div class="line">python3 scripts/plot.py --base-dir outputs --timeout 500</div>
</div><!-- fragment --><p>This generates:</p><ul>
<li>Performance statistics (PAR2 scores, solved instances)</li>
<li>Cumulative time plots</li>
</ul>
<p>The generated <code>combined_results.csv</code> file can be used to generate scatter plots by using the <code>--file</code> and <code>--scatter-plots</code> options.</p>
<p>For complete parameter documentation, see <code><a class="el" href="Parameters_8hpp_source.html">src/utils/Parameters.hpp</a></code>.</p>
<p>For Grid5000-specific support:</p><ul>
<li>Reference: <a href="https://www.grid5000.fr/">https://www.grid5000.fr/</a></li>
<li>Support: <a href="https://www.grid5000.fr/w/Support">https://www.grid5000.fr/w/Support</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<img class="footer" src="./p-logo.png"/>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
Doxygen Theme by&#160;<a href="https://github.com/jothepro/doxygen-awesome-css">doxygen-awesome</a>
</small></address>
</div><!-- doc-content -->
</body>
</html>
